df<-within(df, {lwd <- ifelse( lwt == 110 | lwt > 110, 0, 1)})
df
#Dep and Independent Vars
# define columns we will be working with
depvar <- 'low'
indepvar <- 'lwd'
indepvars <-c('lwd','age')
# two-way contingency table of categorical outcome and predictors we want
#  to make sure there are not 0 cells
xtabs(~get(depvar) + get(indepvar), data = df)
f1 <- paste(depvar,paste(indepvar,collapse=' + '),sep=' ~ ')
fit<-step(glm(f1,data=df,family=binomial),direction="both")
fit
f1 <- paste(depvar,paste(indepvars,collapse=' + '),sep=' ~ ')
fit<-step(glm(f1,data=df,family=binomial),direction="both")
fit
f1 <- paste(depvar,paste(indepvars,collapse=' + '),sep=' ~ ')
fit<-step(glm(f1,data=df,family=binomial),direction="both")
fit
fit<-glm(f1,data=df,family=binomial)
fit
f1 <- paste(depvar,paste(indepvar,collapse=' + '),sep=' ~ ')
f2 <- paste(depvar,paste(indepvars,collapse=' + '),sep=' ~ ')
#Fit the model
#fit<-step(glm(f1,data=df,family=binomial),direction="both")
fit1<-glm(f1,data=df,family=binomial)
fit2<-glm(f2,data=df,family=binomial)
f3 <-paste(depvar,paste(indepvarsinter,collapse=' + '),sep=' ~ ')
indepvarsinter <-c('lwd','age','lwd*age')
f3 <-paste(depvar,paste(indepvarsinter,collapse=' + '),sep=' ~ ')
f3
fit3<-glm(f3,data=df,family=binomial)
fit3
fit1<-glm(f1,data=df,family=binomial)
fit2<-glm(f2,data=df,family=binomial)
fit3<-glm(f3,data=df,family=binomial)
summary(fit) # display results
summary(fit1) # display results
summary(fit1) # display results
confint(fit1) # 95% CI for the coefficients using profiled log-likelihood
confint.default(fit1) # 95% CI for the coefficients using standard errors
#exp(coef(fit)) # exponentiated coefficients a.k.a odds ratios
#exp(confint(fit)) # 95% CI for exponentiated coefficients
exp(cbind(OR = coef(fit1), confint(fit1))) ## odds ratios and 95% CI together
d<-anova(fit1,test='Chisq') # or d<-anova(fit,test='LRT')
d
# get LR
d$Deviance
# Get loglikelihood
logLik(fit1)
reviewit <- function(fit) {
summary(fit) # display results
confint(fit) # 95% CI for the coefficients using profiled log-likelihood
confint.default(fit) # 95% CI for the coefficients using standard errors
exp(cbind(OR = coef(fit), confint(fit))) ## odds ratios and 95% CI together
anova(fit,test='Chisq') # or d<-anova(fit,test='LRT')
# get LR
#d$Deviance
# Get loglikelihood
logLik(fit)
}
reviewit(fit1)
reviewit(fit2)
reviewit(fit3)
reviewit(fit3)
print confint(fit) # 95% CI for the coefficients using profiled log-likelihood
reviewit(fit3)
reviewit(fit3)
eviewit <- function(fit) {
#print(summary(fit)) # display results
#confint(fit) # 95% CI for the coefficients using profiled log-likelihood
#confint.default(fit) # 95% CI for the coefficients using standard errors
#exp(cbind(OR = coef(fit), confint(fit))) ## odds ratios and 95% CI together
anova(fit,test='Chisq') # or d<-anova(fit,test='LRT')
# get LR
#d$Deviance
# Get loglikelihood
#logLik(fit)
}
reviewit <- function(fit) {
#print(summary(fit)) # display results
#confint(fit) # 95% CI for the coefficients using profiled log-likelihood
#confint.default(fit) # 95% CI for the coefficients using standard errors
#exp(cbind(OR = coef(fit), confint(fit))) ## odds ratios and 95% CI together
anova(fit,test='Chisq') # or d<-anova(fit,test='LRT')
# get LR
#d$Deviance
# Get loglikelihood
#logLik(fit)
}
reviewit(fit3)
reviewit <- function(fit) {
print(summary(fit)) # display results
#confint(fit) # 95% CI for the coefficients using profiled log-likelihood
#confint.default(fit) # 95% CI for the coefficients using standard errors
#exp(cbind(OR = coef(fit), confint(fit))) ## odds ratios and 95% CI together
anova(fit,test='Chisq') # or d<-anova(fit,test='LRT')
# get LR
#d$Deviance
# Get loglikelihood
#logLik(fit)
}
reviewit(fit3)
reviewit <- function(fit) {
print(summary(fit)) # display results
print(confint(fit)) # 95% CI for the coefficients using profiled log-likelihood
print(confint.default(fit)) # 95% CI for the coefficients using standard errors
print(exp(cbind(OR = coef(fit), confint(fit)))) ## odds ratios and 95% CI together
print(anova(fit,test='Chisq')) # or d<-anova(fit,test='LRT')
# get LR
#d$Deviance
# Get loglikelihood
print(logLik(fit))
}
reviewit(fit3)
reviewit(fit1)
reviewit(fit2)
reviewit(fit3)
test2<-data.frame(age=30)
fitpred<-predict(fit3,test2,se.fit=TRUE)
test2<-data.frame(age=30,lwd=1)
fitpred<-predict(fit3,test2,se.fit=TRUE)
pi <- cbind(Prob=fitpred$fit,LCL=fitpred$fit - fitpred$se.fit*1.96,UCL=fitpred$fit + fitpred$se.fit*1.96)
pi2 <- cbind(Prob=exp(pi[,1])/(1+exp(pi[,1])),LCL=exp(pi[,2])/(1+exp(pi[,2])),UCL=exp(pi[,3])/(1+exp(pi[,3])))
#Note 59% chance of having a low birthweight baby for a black woman with lwt=100
pi
pi2
fitpred
test2<-data.frame(age=30,lwd=0)
fitpred<-predict(fit3,test2,se.fit=TRUE)
pi <- cbind(Prob=fitpred$fit,LCL=fitpred$fit - fitpred$se.fit*1.96,UCL=fitpred$fit + fitpred$se.fit*1.96)
pi2 <- cbind(Prob=exp(pi[,1])/(1+exp(pi[,1])),LCL=exp(pi[,2])/(1+exp(pi[,2])),UCL=exp(pi[,3])/(1+exp(pi[,3])))
#Note 59% chance of having a low birthweight baby for a black woman with lwt=100
pi
pi2
fitpred
exp(pi)
exp(pi2)
exp(fitpred)
pi <- cbind(Prob=fitpred$fit,LCL=fitpred$fit - fitpred$se.fit*1.96,UCL=fitpred$fit + fitpred$se.fit*1.96)
pi2 <- cbind(Prob=exp(pi[,1])/(1+exp(pi[,1])),LCL=exp(pi[,2])/(1+exp(pi[,2])),UCL=exp(pi[,3])/(1+exp(pi[,3])))
pi
pi2
exp(pi)
exp(pi2)
fitpred
test2<-data.frame(age=30,lwd=1)
fitpred<-predict(fit3,test2,se.fit=TRUE)
pi <- cbind(Prob=fitpred$fit,LCL=fitpred$fit - fitpred$se.fit*1.96,UCL=fitpred$fit + fitpred$se.fit*1.96)
pi2 <- cbind(Prob=exp(pi[,1])/(1+exp(pi[,1])),LCL=exp(pi[,2])/(1+exp(pi[,2])),UCL=exp(pi[,3])/(1+exp(pi[,3])))
#Note 59% chance of having a low birthweight baby for a black woman with lwt=100
ex
pi
pi2
print(exp(cbind(OR = coef(fit), confint(fit)))) ## odds ratios and 95% CI together
reviewit(fit3)
x<-(0,1,1)
y<-(2,2,8)
y<-c(2,2,8)
x<-c(0,1,1)
y<-c(2,2,8)
fit<-lm(y~x )
fit
summary(fit)
test2<-data.frame(x=0)
fitpred<-predict(fit,test2,se.fit=TRUE)
fitpred
summary(fitpred)
summary(fit)
fit$sse
fit$SSE
fit$SST
str(fit)
anova(fit)
aov(fit)
anova(fit)
rm(list-ls())
rm(list=ls())
df<-read.csv("wine.csv")
df<-read.csv(file.choose())
fit<-lm(Price~AGST, data=df)
summary(fit)
mean(df$Price)
df$residuals
fit$residuals
SSE<-sum(df$residuals^2)
SSe
SSE
SSE<-sum(fit$residuals^2)
fit2<-lm(Price~AGST+HarvestRain, data=df)
summary(fit2)
SSE2<-sum(fit2$residuals^2)
SSE2
aov(fit,fit2)
anova(fit,fit2)
fit3<-lm(Price~-1, data=df)
summary(fit2)
summary(fit3)
fit3<-lm(Price~., data=df)
summary(fit3)
Year<-Null
df$Year<-Null
df$Year<-null
df$Year<-NULL
fit3<-lm(Price~., data=df)
summary(fit3)
SSE3<-sum(fit3$residuals^2)
SSE3
# Load functions
source('functions.R')
# Load the data
#Load the birthweight data (lowbw.csv)
#df<-read.csv(file.choose())
df<-read.csv("D:/Data/wine.csv")
# Clean
df<- cleanit(df)
# remove a column
df$year <-NULL
summary(fit)
fit<-lm(Price~AGST, data=df)
fit<-lm(price~agst, data=df)
summary(fit)
SSE1<-sum(fit1$residuals^2)
SSE1
SSE1<-sum(fit1$residuals^2)
fit1<-lm(price~agst, data=df)
SSE1<-sum(fit1$residuals^2)
SSE2<-sum(fit2$residuals^2)
SSE1<-sum(fit1$residuals^2)
SSE1
fit3<-lm(price~., data=df)
summary(fit3)
SSE3<-sum(fit3$residuals^2)
SSE3
fit2<-lm(price~agst+harvestrain, data=df)
summary(fit2)
SSE2<-sum(fit2$residuals^2)
SSE2
fit4<-lm(price~harvestrain+winterrain, data=df)
summary(fit4)
SSE4<-sum(fit4$residuals^2)
SSE4
summary(fit3)
fit2<-lm(price~agst+harvestrain, data=df)
summary(fit2)
SSE2<-sum(fit2$residuals^2)
SSE2
fit4<-lm(price~harvestrain+winterrain, data=df)
summary(fit4)
SSE4<-sum(fit4$residuals^2)
SSE4
fit1<-lm(price~agst, data=df)
summary(fit1)
SSE1<-sum(fit1$residuals^2)
SSE1
fit3<-lm(price~., data=df)
summary(fit3)
SSE3<-sum(fit3$residuals^2)
SSE3
fit2<-lm(price~agst+harvestrain, data=df)
summary(fit2)
SSE2<-sum(fit2$residuals^2)
SSE2
fit2<-lm(price~agst+harvestrain+agst*harvestrain, data=df)
summary(fit2)
SSE2<-sum(fit2$residuals^2)
SSE2
fit5<-lm(price~agst+harvestrain+winterrain, data=df)
summary(fit5)
SSE5<-sum(fit5$residuals^2)
SSE5
anova(fit2,fit5)
summary(fit4)
anova(fit2,fit5)
fit2<-lm(price~agst+harvestrain, data=df)
summary(fit2)
SSE2<-sum(fit2$residuals^2)
SSE2
anova(fit2,fit5)
anova(fit2,fit3)
anova(fit1,fit2)
anova(fit1,fit3)
anova(fit1,fit4)
anova(fit1,fit5)
fit4<-lm(price~agst+harvestrain+winterrain+age, data=df)
summary(fi4)
SSE4<-sum(fit4$residuals^2)
SSE4
anova(fit1,fit4)
anova(fit2,fit3)
anova(fit2,fit4)
anova(fit3,fit4)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
anova(fit1,fit2,fit3,fit4
)
anova(fit1,fit2,fit3,fit4)
summary(fit4)
fit4$adjustedRsquare
str(fit4)
summary(fit4)$r.squared
str(summary(fit))
str(summary(fit3))
summary(fit4)$adj.r.squared
cbind("Model1",summary(fit1)$adj.r.squared,"Model2",summary(fit1)$adj.r.squared)
cbind(Model1,summary(fit1)$adj.r.squared,Model2,summary(fit1)$adj.r.squared)
cbind(Model1=summary(fit1)$adj.r.squared,Model2=summary(fit1)$adj.r.squared)
cbind(Model1=summary(fit1)$r.squared,Model2=summary(fit1)$adj.r.squared)
cbind(Model1=summary(fit1)$r.squared,Model2=summary(fit2)$adj.r.squared,Model3=summary(fit3)$adj.r.squared,Model4=summary(fit4)$adj.r.squared)
cbind(Model1=summary(fit1)$r.squared,Model2=summary(fit2)$adj.r.squared,Model3=summary(fit3)$adj.r.squared,Model4=summary(fit4)$adj.r.squared)
cbind(Model1=SSE1,Model2=SSE2,Model3=SSE3,Model4=SSE4)
cbind(R2Model1=summary(fit1)$r.squared,R2Model2=summary(fit2)$adj.r.squared,R2Model3=summary(fit3)$adj.r.squared,R2Model4=summary(fit4)$adj.r.squared)
cbind(Model1=SSE1,SSEModel2=SSE2,Model3=SSE3,Model4=SSE4)
cbind(R2Model1=summary(fit1)$r.squared,R2Model2=summary(fit2)$adj.r.squared,R2Model3=summary(fit3)$adj.r.squared,R2Model4=summary(fit4)$adj.r.squared)
cbind(SSEModel1=SSE1,SSEModel2=SSE2,SSEModel3=SSE3,SSEModel4=SSE4)
View(df)
cor(df$age,df$francepop)
cor(df)
vif
VIF(df)
plot(df)
cbind(R2Model1=summary(fit1)$r.squared,R2Model2=summary(fit2)$adj.r.squared,R2Model3=summary(fit3)$adj.r.squared,R2Model4=summary(fit4)$adj.r.squared)
fit4<-lm(price~agst+harvestrain+winterrain+age, data=df)
summary(fit4)
fSSE4<-sum(fit4$residuals^2)
SSE4
dftest<-read.csv("D:/Data/wine_test.csv")
dftest<-cleanit(dftest)
predicttest<-(predict,fit4,newdata=dftest)
predicttest<-predict(fit4,newdata=dftest)
predicttest
SSETEST<- sum((dftest$price - predicttest)^2)
SSTTEST<- sum((dftest$price - mean(df$price))^2)
1-(SSETEST/SSTTEST)
cbind(R2Model1=summary(fit1)$r.squared,R2Model2=summary(fit2)$r.squared,R2Model3=summary(fit3)$r.squared,R2Model4=summary(fit4)$r.squared)
cbind(SSEModel1=SSE1,SSEModel2=SSE2,SSEModel3=SSE3,SSEModel4=SSE4)
predicttest<-predict(fit1,newdata=dftest)
#Compute SSE
SSETEST<- sum((dftest$price - predicttest)^2)
SSTTEST<- sum((dftest$price - mean(df$price))^2)
1-(SSETEST/SSTTEST)
predicttest<-predict(fit1,newdata=dftest)
SSETEST<- sum((dftest$price - predicttest)^2)
SSTTEST<- sum((dftest$price - mean(df$price))^2)
r2model1<-1-(SSETEST/SSTTEST)
predicttest<-predict(fit2,newdata=dftest)
SSETEST<- sum((dftest$price - predicttest)^2)
SSTTEST<- sum((dftest$price - mean(df$price))^2)
r2model2<-1-(SSETEST/SSTTEST)
predicttest<-predict(fit3,newdata=dftest)
SSETEST<- sum((dftest$price - predicttest)^2)
SSTTEST<- sum((dftest$price - mean(df$price))^2)
r2model3<-1-(SSETEST/SSTTEST)
#Predict, Compute SSE, SST and R^2
predicttest<-predict(fit1,newdata=dftest)
SSETEST<- sum((dftest$price - predicttest)^2)
SSTTEST<- sum((dftest$price - mean(df$price))^2)
r2model1<-1-(SSETEST/SSTTEST)
predicttest<-predict(fit2,newdata=dftest)
SSETEST<- sum((dftest$price - predicttest)^2)
SSTTEST<- sum((dftest$price - mean(df$price))^2)
r2model2<-1-(SSETEST/SSTTEST)
predicttest<-predict(fit3,newdata=dftest)
SSETEST<- sum((dftest$price - predicttest)^2)
SSTTEST<- sum((dftest$price - mean(df$price))^2)
r2model3<-1-(SSETEST/SSTTEST)
predicttest<-predict(fit4,newdata=dftest)
SSETEST<- sum((dftest$price - predicttest)^2)
SSTTEST<- sum((dftest$price - mean(df$price))^2)
r2model4<-1-(SSETEST/SSTTEST)
#Predict, Compute SSE, SST and R^2
predicttest<-predict(fit1,newdata=dftest)
SSETEST1<- sum((dftest$price - predicttest)^2)
SSTTEST1<- sum((dftest$price - mean(df$price))^2)
r2model1<-1-(SSETEST1/SSTTEST1)
predicttest<-predict(fit2,newdata=dftest)
SSETEST2<- sum((dftest$price - predicttest)^2)
SSTTEST2<- sum((dftest$price - mean(df$price))^2)
r2model2<-1-(SSETEST2/SSTTEST2)
predicttest<-predict(fit3,newdata=dftest)
SSETEST3<- sum((dftest$price - predicttest)^2)
SSTTEST3<- sum((dftest$price - mean(df$price))^2)
r2model3<-1-(SSETEST3/SSTTEST3)
predicttest<-predict(fit4,newdata=dftest)
SSETEST4<- sum((dftest$price - predicttest)^2)
SSTTEST4<- sum((dftest$price - mean(df$price))^2)
r2model4<-1-(SSETEST4/SSTTEST4)
SSEPredict<-cbind(SSEPredict1=SSETEST1,SSEPredict2=SSETEST2,SSEPredict3=SSETEST3,SSEPredict4=SSETEST4)
SSEPREDICT
SSEPredict
R2Predict<-cbind(R2Test1=r2model1,R2Test2=r2model2,R2Test3=r2model3,R2test4=r2model4)
R2Predict
cbind(R2Predict,SSEPredict)
rbind(R2Predict,SSEPredict)
rbind(R2Models,R2Predict,SSEModels,SSEPredict)
rbind(R2Models,R2Predict,SSEModels,SSEPredict)
R2Models<-cbind(R2Model1=summary(fit1)$r.squared,R2Model2=summary(fit2)$r.squared,R2Model3=summary(fit3)$r.squared,R2Model4=summary(fit4)$r.squared)
SSEModels<-cbind(SSEModel1=SSE1,SSEModel2=SSE2,SSEModel3=SSE3,SSEModel4=SSE4)
rbind(R2Models,R2Predict,SSEModels,SSEPredict)
rbind(ModelR2=R2Models,PredictR2=R2Predict,SSEModels,SSEPredict)
rbind(ModelR2=R2Models,PredictR2=R2Predict,SSEModels,SSEPredict)
rbind(R2Models,R2Predict,SSEModels,SSEPredict)
?rbind
rbind(R2Models,R2Predict,SSEModels,SSEPredict,make.row.names=TRUE)
rbind(ModelR^2=R2Models,R2Predict,SSEModels,SSEPredict,make.row.names=TRUE)
rbind(ModelR2=R2Models,R2Predict,SSEModels,SSEPredict,make.row.names=TRUE)
rbind(ModelR2=R2Models,R2Predict,SSEModels,SSEPredict,deparse.level = 1)
rbind(ModelR2=R2Models,R2Predict,SSEModels,SSEPredict,deparse.level = 2)
rbind(ModelR2=R2Models,R2Predict,SSEModels,SSEPredict,deparse.level = 0)
rbind(ModelR2=R2Models,R2Predict,SSEModels,SSEPredict,deparse.level = 1)
rbind(R2Models,R2Predict,SSEModels,SSEPredict,deparse.level = 1)
rbind(R2Models,R2Predict,SSEModels,SSEPredict,dd,deparse.level = 1)
rbind(R2Models,R2Predict,SSEModels,SSEPredict,row.names=c("R","SSE","R2","SSE"))
x<- rbind(R2Models,R2Predict,SSEModels,SSEPredict)
x<- rbind(R2Models,R2Predict,SSEModels,SSEPredict)
x
?row.names
row.names(x)<-c("R2Model","SSEModel","R2Predict","SSEPredict")
x
row.names(x)<-c("R2Model","R2Predict","SSEModel","SSEPredict")
x
dftrain<-read.csv("D:/Data/baseball.csv")
dftrain<-cleanit(dftrain)
dftrain<-subset(dftrain, year< 2002)
View(dftrain)
dftrain$rd<- dftrainrs - dftrainra
dftrain$rd<- dftrain$rs - dftrain$ra
View(dftrain)
cor(dftrain)
corr(dftrain)
cor(dftrain[,-1:2])
cor(dftrain[,3:])
cor(dftrain[,3:10])
cor(dftrain[,3:16])
plot(dftrain[,3:16])
View(dftrain)
depvar <- 'w'
indepvars <-c('rd')
f1 <- paste(depvar,paste(indepvars,collapse=' + '),sep=' ~ ')
fit<-lm(f1,data=dftrain)
fit
dftest<-c(rd=713-614)
predict(fit,newdata=dftest)
dftest<-data.frame(rd=713-614)
predict(fit,newdata=dftest)
depvar <- 'rs'
indepvars <-c('obp','slg','ba')
f1 <- paste(depvar,paste(indepvars,collapse=' + '),sep=' ~ ')
fitrs<--lm(f1,data=dftrain)
summary(fitrs)
fitrs<--lm(f1,data=dftrain)
fitrs<-lm(f1,data=dftrain)
summary(fitrs)
indepvars <-c('obp','slg')
f1 <- paste(depvar,paste(indepvars,collapse=' + '),sep=' ~ ')
fitrs<-lm(f1,data=dftrain)
summary(fitrs)
depvar <- 'ra'
indepvars <-c('oobp','oslg')
f1 <- paste(depvar,paste(indepvars,collapse=' + '),sep=' ~ ')
fitra<-lm(f1,data=dftrain)
summary(fitra)
#Make a prediction on runs score when OBP is 0.311 and SLG is 0.405
dftest<-data.frame(obp=0.311, slg=0.405)
predict(fitra,newdata=dftest)
dftest<-data.frame(obp=0.311, slg=0.405)
predict(fitrs,newdata=dftest)
dftest<-data.frame(oobp=0.297, oslg=0.370)
predict(fitra,newdata=dftest)
teamRank = c(1,2,3,3,4,4,4,4,5,5)
wins2012 <- c(94,88,95,88,93,94,98,97,93,94)
wins2013<-c(97,97,92,93,92,96,94,96,92,90)
cor(teamRank,wins2012)
cor(teamRank,wins2013)
# Load functions
source('functions.R')
IBM<-read.csv("D:/Data/IBMStock.csv")
GE<-read.csv("D:/Data/GEStock.csv")
ProcterGamble<-read.csv("D:/Data/ProcterGambleStock.csv")
CocaCola<-read.csv("D:/Data/CocaColaStock.csv")
Boeing<-read.csv("D:/Data/BoeingStock.csv")
IBM$Date = as.Date(IBM$Date, "%m/%d/%y")
GE$Date = as.Date(GE$Date, "%m/%d/%y")
CocaCola$Date = as.Date(CocaCola$Date, "%m/%d/%y")
ProcterGamble$Date = as.Date(ProcterGamble$Date, "%m/%d/%y")
Boeing$Date = as.Date(Boeing$Date, "%m/%d/%y")
max(Boeing$Date)
mean(IBM$Price)
mean(IBM$StockPrice)
min(GE$StockPrice)
max(CocaCola$StockPrice)
median(Boeing$StockPrice)
sd(ProcterGamble$StockPrice)
plot(CocaCola$Date,CocaCola$StockPrice)
plot(CocaCola$Date,CocaCola$StockPrice,type="l")
lines(ProcterGamble$Date, ProcterGamble$StockPrice)
plot(CocaCola$Date,CocaCola$StockPrice,type="l",col="red")
lines(ProcterGamble$Date, ProcterGamble$StockPrice,col="blue")
abline(v=as.Date(c("2000-03-01")), lwd=2)
abline(v=as.Date(c("2003-03-01")), lwd=2)
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210))
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432],col="blue")
lines(oeing$Date[301:432], Boeing$StockPrice[301:432],col="green")
lines(Boeing$Date[301:432], Boeing$StockPrice[301:432],col="green")
lines(IBM$Date[301:432], IBM$StockPrice[301:432],col="purple")
lines(GE$Date[301:432], GE$StockPrice[301:432],col="orange")
abline(v=as.Date(c("2002-03-01")), lwd=2)
abline(v=as.Date(c("2005-03-01")), lwd=2)
plot(CocaCola$Date,CocaCola$StockPrice,type="l")
?tapply
tapply(IBM,months(IBM$Date),sort)
