---
title: "T-Test"
author: "Dr. B"
date: "Thursday, November 13, 2014"
output: html_document
---

A few different T Tests
```{r,warning=FALSE}
#Set globals, load libraries, and load and attach the data
# Turn off scientific notations for numbers
options(scipen = 999)  

if(!require("doBy")){
        Install.packages("doBy")
}

##Attach the Data
attach(ToothGrowth)
```

The ToothGrowth dataset explains the relation between the length of teeth in each of 10 guinea pigs at each of three dose levels of Vitamin C (0.5, 1 and 2 mg) with each of two supplement types (orange juice and ascorbic acid). 

First, we make a boxplot
```{r,echo=FALSE}
with(ToothGrowth, {
    boxplot(len ~ dose, boxwex = 0.25, at = 1:3 - 0.2,
            subset = (supp == "VC"), col = "yellow",
            main = "Guinea Pigs' Tooth Growth",
            xlab = "Vitamin C dose mg",
            ylab = "tooth length", ylim = c(0, 35))
    boxplot(len ~ dose, add = TRUE, boxwex = 0.25, at = 1:3 + 0.2,
            subset = supp == "OJ", col = "orange")
    legend(2, 9, c("Ascorbic acid", "Orange juice"),
           fill = c("yellow", "orange"))
})
```

A table
```{r}
table(dose,supp)
```
###Summaries
Next, we will look at the mean, variance, and standard deviation of tooth length, group by supplement type and dose.
```{r}
###Basic Summary of the Data 
summaryBy(len~supp+dose, data=ToothGrowth, FUN=c(mean,var,sd,length))
```

###Hypothesis Tests and Confidence Intervals
####Paired By Supplement
The hypothesis test was that there was no difference in tooth length between orange juice and ascorbic acid.  The alternative hypothesis was that orange juice increased tooth length more than ascorbic acid did.
```{r}
results <-t.test(len[supp=="OJ"],len[supp=="VC"],paired=TRUE, alternative = c("greater"))
results
```

####Paired By Dose (2 versus 1)
The null hypothesis was that there was no difference in tooth length between 2 mg and 1 mg dose levels.  The alternative hypothesis was that the 2 mg dose increased tooth length more than 1 mg dose did.
```{r}
results <-t.test(len[dose==2],len[dose==1],paired=TRUE, alternative = c("greater"))
results
```

####Paired By Dose (1 versus .5)
The null hypothesis was that there was no difference in tooth length between the 1 mg and .5 mg dose levels.  The alternative hypothesis was that the 1 mg dose increased tooth length more than .5 mg dose did.
```{r}
results <-t.test(len[dose==1],len[dose==.5],paired=TRUE, alternative = c("greater"))
results
```

####Independent (assume equal var) By Dose (2 versus 1)
The null hypothesis was that there was no difference in tooth length between 2 mg and 1 mg dose levels.  The alternative hypothesis was that the 2 mg dose increased tooth length more than 1 mg dose did.
```{r}
results <-t.test(len[dose==2],len[dose==1],var.equal=TRUE, alternative = c("greater"))
results
```

####Independent (assume equal var) By Dose (1 versus .5)
The null hypothesis was that there was no difference in tooth length between 2 mg and 1 mg dose levels.  The alternative hypothesis was that the 1 mg dose increased tooth length more than .5 mg dose did.
```{r}
results <-t.test(len[dose==1],len[dose==.5],var.equal=TRUE, alternative = c("greater"))
results
```

###One-Way Anova by Dose
```{r}
output <- aov(len ~ dose)
model.tables(output,"means")
summary(output)
plot(output)
```

###Post Hoc Tests
####Pairwise T Test
The function pairwise.t.test computes the pair-wise comparisons between group means with corrections for multiple testing. The general form is pairwise.t.test(reponse, factor, p.adjust = method, alternative = c("two.sided","less", "greater"))
```{r}
pairwise.t.test(len, dose,  p.adjust="bonferroni")
```


###Anova by Supplement & Dose
####Multiple OLS Linear
```{r}
output <- aov(len ~ supp + dose)
model.tables(output,"means")
summary(output)
plot(output)
```

####Multiple OLS Linear with Interaction
```{r}
output <- aov(len ~ supp*dose)
model.tables(output,"means")
summary(output)
plot(output)
```